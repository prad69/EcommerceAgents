from datetime import datetime\nfrom typing import Optional, List, Dict, Any\nfrom pydantic import BaseModel, Field\n\nfrom .product import ProductResponse\n\n\nclass RecommendationRequest(BaseModel):\n    user_id: Optional[str] = None\n    query: str = Field(..., min_length=1, max_length=500)\n    context: str = Field(\"general\")  # homepage, product_page, cart, search\n    filters: Optional[Dict[str, Any]] = Field(default_factory=dict)\n    limit: int = Field(10, ge=1, le=100)\n    include_metadata: bool = False\n\n\nclass RecommendationResponse(BaseModel):\n    products: List[ProductResponse]\n    query: str\n    context: str\n    total_results: int\n    response_time: float\n    algorithm_used: str\n    metadata: Optional[Dict[str, Any]] = None\n\n\nclass SimilarityScore(BaseModel):\n    product_id: str\n    similarity_score: float\n    reasons: List[str]  # Why this product is similar\n\n\nclass RecommendationFeedback(BaseModel):\n    user_id: str\n    product_id: str\n    recommendation_id: str\n    action: str  # clicked, purchased, dismissed, liked\n    context: str\n    timestamp: datetime\n    metadata: Optional[Dict[str, Any]] = None\n\n\nclass PersonalizationProfile(BaseModel):\n    user_id: str\n    preferred_categories: List[str]\n    preferred_brands: List[str]\n    price_range: Dict[str, float]  # {\"min\": 0, \"max\": 1000}\n    interaction_history: List[str]  # Product IDs\n    embedding_vector: Optional[List[float]] = None\n    last_updated: datetime\n\n\nclass TrendingProduct(BaseModel):\n    product: ProductResponse\n    trending_score: float\n    growth_rate: float\n    category_rank: int\n    overall_rank: int