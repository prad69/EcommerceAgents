#!/usr/bin/env python3\n\"\"\"\nDatabase seeding script for EcommerceAgents\nCreates sample data for development and testing\n\"\"\"\n\nimport asyncio\nimport sys\nimport os\nfrom typing import Dict, Any, List\n\n# Add src to path\nsys.path.append(os.path.join(os.path.dirname(__file__), '..'))\n\nfrom src.core.database import init_database, SessionLocal\nfrom src.services.data_ingestion import DataIngestionService\nfrom loguru import logger\n\n\ndef create_sample_data() -> List[Dict[str, Any]]:\n    \"\"\"\n    Create sample product data for testing\n    \"\"\"\n    return [\n        {\n            \"title\": \"iPhone 15 Pro\",\n            \"description\": \"The latest iPhone with Pro features and titanium design\",\n            \"short_description\": \"Latest iPhone Pro model\",\n            \"price\": 999.99,\n            \"original_price\": 1099.99,\n            \"category\": \"Electronics > Smartphones\",\n            \"brand\": \"Apple\",\n            \"sku\": \"iphone-15-pro-001\",\n            \"stock_quantity\": 50,\n            \"features\": [\"A17 Pro chip\", \"ProRAW\", \"Action Button\", \"USB-C\"],\n            \"tags\": [\"smartphone\", \"apple\", \"premium\", \"5g\"],\n            \"images\": [\"https://example.com/iphone15pro.jpg\"],\n            \"average_rating\": 4.8,\n            \"review_count\": 245,\n            \"data_source\": \"sample\"\n        },\n        {\n            \"title\": \"Samsung Galaxy S24 Ultra\",\n            \"description\": \"Premium Android smartphone with S Pen and advanced cameras\",\n            \"short_description\": \"Galaxy S24 Ultra with S Pen\",\n            \"price\": 1199.99,\n            \"category\": \"Electronics > Smartphones\",\n            \"brand\": \"Samsung\",\n            \"sku\": \"galaxy-s24-ultra-001\",\n            \"stock_quantity\": 30,\n            \"features\": [\"200MP Camera\", \"S Pen\", \"120Hz Display\", \"5000mAh Battery\"],\n            \"tags\": [\"smartphone\", \"samsung\", \"android\", \"camera\"],\n            \"images\": [\"https://example.com/galaxys24ultra.jpg\"],\n            \"average_rating\": 4.7,\n            \"review_count\": 189,\n            \"data_source\": \"sample\"\n        },\n        {\n            \"title\": \"MacBook Pro 14-inch M3\",\n            \"description\": \"Powerful laptop with M3 chip for professional workflows\",\n            \"short_description\": \"MacBook Pro with M3 chip\",\n            \"price\": 1999.99,\n            \"category\": \"Electronics > Laptops\",\n            \"brand\": \"Apple\",\n            \"sku\": \"macbook-pro-14-m3-001\",\n            \"stock_quantity\": 20,\n            \"features\": [\"M3 chip\", \"14-inch Liquid Retina XDR\", \"20-hour battery\", \"MagSafe 3\"],\n            \"tags\": [\"laptop\", \"apple\", \"professional\", \"m3\"],\n            \"images\": [\"https://example.com/macbookpro14.jpg\"],\n            \"average_rating\": 4.9,\n            \"review_count\": 156,\n            \"data_source\": \"sample\"\n        },\n        {\n            \"title\": \"Sony WH-1000XM5\",\n            \"description\": \"Industry-leading noise canceling wireless headphones\",\n            \"short_description\": \"Premium noise canceling headphones\",\n            \"price\": 399.99,\n            \"original_price\": 429.99,\n            \"category\": \"Electronics > Audio\",\n            \"brand\": \"Sony\",\n            \"sku\": \"sony-wh1000xm5-001\",\n            \"stock_quantity\": 75,\n            \"features\": [\"30-hour battery\", \"Quick Charge\", \"Multipoint connection\", \"Speak-to-Chat\"],\n            \"tags\": [\"headphones\", \"wireless\", \"noise-canceling\", \"sony\"],\n            \"images\": [\"https://example.com/sonywh1000xm5.jpg\"],\n            \"average_rating\": 4.6,\n            \"review_count\": 892,\n            \"data_source\": \"sample\"\n        },\n        {\n            \"title\": \"Nike Air Max 270\",\n            \"description\": \"Lifestyle shoe with large Max Air unit for all-day comfort\",\n            \"short_description\": \"Comfortable lifestyle sneakers\",\n            \"price\": 150.00,\n            \"category\": \"Fashion > Shoes > Sneakers\",\n            \"brand\": \"Nike\",\n            \"sku\": \"nike-air-max-270-001\",\n            \"stock_quantity\": 100,\n            \"features\": [\"Max Air cushioning\", \"Breathable mesh\", \"Rubber outsole\", \"Heel tab\"],\n            \"tags\": [\"sneakers\", \"nike\", \"casual\", \"comfort\"],\n            \"images\": [\"https://example.com/nikeairmax270.jpg\"],\n            \"average_rating\": 4.4,\n            \"review_count\": 1243,\n            \"data_source\": \"sample\"\n        },\n        {\n            \"title\": \"Kindle Paperwhite (11th Gen)\",\n            \"description\": \"Waterproof e-reader with adjustable warm light\",\n            \"short_description\": \"Waterproof e-reader\",\n            \"price\": 139.99,\n            \"category\": \"Electronics > E-readers\",\n            \"brand\": \"Amazon\",\n            \"sku\": \"kindle-paperwhite-11-001\",\n            \"stock_quantity\": 200,\n            \"features\": [\"6.8\\\" display\", \"Waterproof\", \"Adjustable warm light\", \"10-week battery\"],\n            \"tags\": [\"e-reader\", \"kindle\", \"reading\", \"waterproof\"],\n            \"images\": [\"https://example.com/kindlepaperwhite.jpg\"],\n            \"average_rating\": 4.5,\n            \"review_count\": 3456,\n            \"data_source\": \"sample\"\n        },\n        {\n            \"title\": \"Instant Pot Duo 7-in-1\",\n            \"description\": \"Multi-use electric pressure cooker with 7 appliances in 1\",\n            \"short_description\": \"7-in-1 electric pressure cooker\",\n            \"price\": 89.99,\n            \"original_price\": 119.99,\n            \"category\": \"Home & Kitchen > Small Appliances\",\n            \"brand\": \"Instant Pot\",\n            \"sku\": \"instant-pot-duo-7in1-001\",\n            \"stock_quantity\": 45,\n            \"features\": [\"7-in-1 functionality\", \"6-quart capacity\", \"10 safety features\", \"Free app\"],\n            \"tags\": [\"kitchen\", \"pressure-cooker\", \"appliance\", \"cooking\"],\n            \"images\": [\"https://example.com/instantpotduo.jpg\"],\n            \"average_rating\": 4.7,\n            \"review_count\": 2156,\n            \"data_source\": \"sample\"\n        },\n        {\n            \"title\": \"Fitbit Charge 5\",\n            \"description\": \"Advanced fitness tracker with built-in GPS and health metrics\",\n            \"short_description\": \"Advanced fitness tracker\",\n            \"price\": 199.99,\n            \"category\": \"Electronics > Wearables > Fitness Trackers\",\n            \"brand\": \"Fitbit\",\n            \"sku\": \"fitbit-charge-5-001\",\n            \"stock_quantity\": 80,\n            \"features\": [\"Built-in GPS\", \"Stress management\", \"Sleep score\", \"6-day battery\"],\n            \"tags\": [\"fitness\", \"tracker\", \"health\", \"wearable\"],\n            \"images\": [\"https://example.com/fitbitcharge5.jpg\"],\n            \"average_rating\": 4.2,\n            \"review_count\": 789,\n            \"data_source\": \"sample\"\n        },\n        {\n            \"title\": \"LEGO Creator 3-in-1 Deep Sea Creatures\",\n            \"description\": \"Build a shark, squid, or angler fish with this 3-in-1 set\",\n            \"short_description\": \"3-in-1 LEGO sea creatures set\",\n            \"price\": 79.99,\n            \"category\": \"Toys & Games > Building Sets\",\n            \"brand\": \"LEGO\",\n            \"sku\": \"lego-creator-deep-sea-001\",\n            \"stock_quantity\": 60,\n            \"features\": [\"3-in-1 build\", \"230 pieces\", \"Poseable joints\", \"Ages 7+\"],\n            \"tags\": [\"lego\", \"toys\", \"building\", \"creative\"],\n            \"images\": [\"https://example.com/legodeepsea.jpg\"],\n            \"average_rating\": 4.8,\n            \"review_count\": 234,\n            \"data_source\": \"sample\"\n        },\n        {\n            \"title\": \"The Seven Husbands of Evelyn Hugo\",\n            \"description\": \"A captivating novel about a reclusive Hollywood icon\",\n            \"short_description\": \"Bestselling novel\",\n            \"price\": 16.99,\n            \"original_price\": 19.99,\n            \"category\": \"Books > Fiction > Contemporary\",\n            \"brand\": \"Simon & Schuster\",\n            \"sku\": \"seven-husbands-evelyn-001\",\n            \"stock_quantity\": 150,\n            \"features\": [\"384 pages\", \"Paperback\", \"Bestseller\", \"Book Club Pick\"],\n            \"tags\": [\"book\", \"fiction\", \"bestseller\", \"hollywood\"],\n            \"images\": [\"https://example.com/sevenhusbands.jpg\"],\n            \"average_rating\": 4.6,\n            \"review_count\": 45789,\n            \"data_source\": \"sample\"\n        }\n    ]\n\n\nasync def seed_database():\n    \"\"\"\n    Seed the database with sample data\n    \"\"\"\n    logger.info(\"Starting database seeding...\")\n    \n    try:\n        # Initialize database\n        init_database()\n        logger.info(\"Database initialized\")\n        \n        # Create data ingestion service\n        ingestion_service = DataIngestionService()\n        \n        # Create sample data\n        sample_products = create_sample_data()\n        logger.info(f\"Created {len(sample_products)} sample products\")\n        \n        # Ingest sample data\n        results = await ingestion_service._batch_ingest(sample_products, batch_size=5)\n        \n        logger.info(f\"Database seeding completed:\")\n        logger.info(f\"  - Successfully ingested: {results['successful']} products\")\n        logger.info(f\"  - Failed to ingest: {results['failed']} products\")\n        \n        if results['errors']:\n            logger.warning(\"Errors encountered:\")\n            for error in results['errors']:\n                logger.warning(f\"  - {error['product_sku']}: {error['error']}\")\n        \n        return results\n        \n    except Exception as e:\n        logger.error(f\"Database seeding failed: {e}\")\n        raise\n\n\ndef main():\n    \"\"\"\n    Main function to run the seeding script\n    \"\"\"\n    logger.info(\"EcommerceAgents Database Seeding Script\")\n    logger.info(\"=\" * 40)\n    \n    try:\n        # Run seeding\n        results = asyncio.run(seed_database())\n        \n        print(\"\\n\" + \"=\" * 40)\n        print(\"SEEDING COMPLETED SUCCESSFULLY\")\n        print(\"=\" * 40)\n        print(f\"Products ingested: {results['successful']}\")\n        print(f\"Products failed: {results['failed']}\")\n        \n        if results['failed'] > 0:\n            print(f\"\\nCheck logs for error details.\")\n        \n        return 0\n        \n    except Exception as e:\n        print(f\"\\nSEEDING FAILED: {e}\")\n        return 1\n\n\nif __name__ == \"__main__\":\n    exit_code = main()\n    sys.exit(exit_code)"